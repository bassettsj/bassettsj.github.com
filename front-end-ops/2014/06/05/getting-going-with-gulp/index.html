<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Getting going with gulpãƒ»Steven Bassett</title><meta name="author" content="Steven Bassett"><meta name="theme-color" content="#f8f8f8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <script src="/assets/js/respond.min.js"></script>
  <![endif]--><link rel="preload" href="https://unpkg.com/st-img@0.1.1/dist/stimg.js" as="script"><link rel="preload" href="/assets/js/main.pkg.js" as="script"><link ref="preload" href="https://www.google-analytics.com/analytics.js" as="script"><link rel="dns-prefetch" href="https://fonts.googleapis.com/"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="dns-prefetch" href="https://unpkg.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link href="/assets/css/i.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Lato:400|Vollkorn:400" rel="stylesheet"></head><body><a name="top"></a> <a href="#main-content" class="sr-only-focusable">Skip to main content</a><div class="container"><header class="site-header" role="banner"><nav><a href="/" class="site-title"><b>S</b><span>teven Bassett</span></a><nav role="navigation"><ul class="nav"><li><a href="/archive/" class="active">Archive</a></li><li><a href="/info/">Info</a></li><li><a href="/projects/">Projects</a></li><li><a href="/search/">Search</a></li></ul></nav></nav></header><main class="content" role="main" id="main-content"><article class="post"><header class="page-title"><h1>Getting going with gulp</h1><p class="intro">What all the cool kids are doing...</p></header><div class="post-content"><p>Coming off of having a presentation on the subject of front-end operations using grunt, I was feeling like I have a certain amount of expertise with Grunt, and a new appriciation for it, but now I want to try my hand out on the new Gulp build tool for Node.js. Gulp leverages the core power behind Node.js and uses it to enforce developers to not write out verbose configuration files, but rather write their own tasks using the Node APIs.</p><h3>Getting started</h3><h4>Install CLI</h4><p>You need to install gulp globally first so that it can be available on your path, to test try using the <code>--version</code> to make sure that it is installed correctly.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">$ npm install -g gulp
...
$ gulp --version
[gulp] [14:06:30] CLI version 3.7.0
</code></pre></figure><h4>Package.json and packages!</h4><p>If you don&#39;t already have a <code>package.json</code> in your project, you may want to use <code>npm init</code> to get the nice little CLI dialog to create it for you. Once the file is available, we will want to install a local gulp package, <code>npm install --save-dev gulp</code>. Now we can get started.</p><h4>Using coffeesript?</h4><p>I try to use CoffeeScript whenever possible, I find there is less of a change of syntax errors like missing semi-colons or commas. Grunt had built in support for CoffeeScript, but Gulp does not, and I doubt it will. The easiest way I found to allow you to write tasks in coffee-script is by requiring it at the base <code>gulpfile.js</code>. You will also need to install it with <code>npm install --save-dev coffee-script</code>. I wanted to seperate out the tasks into a couple of small files as well, in a directory I called <code>_gulp</code> so jekyll will ignore it by default.</p><figure class="highlight"><pre><code class="language-javascript" data-lang="javascript">/**
* @file gulpfile.js
*/

require(&#39;coffee-script/register&#39;);
// then the coffeescript can be compiled on the fly.

// included a new file in _gulp folder
// added that since the project is a jekyll blog
require(&#39;./_gulp/index.coffee&#39;);
</code></pre></figure><h4>First task</h4><p>Well let&#39;s compile sass down, there are two good plugin&#39;s out there. The first, <a href="https://github.com/dlmanning/gulp-sass"><code>gulp-sass</code></a> uses the <a href="https://github.com/andrew/node-sass"><code>node-sass</code></a>, which is wicked fast, but has less features and less stable. I went with the ruby sass plugin, <a href="https://github.com/sindresorhus/gulp-ruby-sass"><code>gulp-ruby-sass</code></a>. Then it was pretty easy to get the plugin added to my project. Install the gulp plugin with <code>npm install --save-dev gulp-ruby-sass</code>.</p><figure class="highlight"><pre><code class="language-coffeescript" data-lang="coffeescript">##
@file ./_gulp/index.coffee
##

gulp = require(&#39;gulp&#39;) #load gulp
sass = require(&#39;gulp-ruby-sass&#39;) # load the gulp sass plugin

</code></pre></figure><p>Now that we have these set up, I added the first task using the <code>gulp.task</code> method to add the new task to the markup.</p><figure class="highlight"><pre><code class="language-coffeescript" data-lang="coffeescript">#contiued above, register the task
gulp.task(&#39;styles&#39;, -&gt;
  gulp.src(&#39;./_scss/**/*.scss&#39;) #the source
    # pipe is streaming the results to the next task
    .pipe(sass()) # the sass plugin compiles here
    .pipe(gulp.dest(&#39;./assets/css/&#39;)) # then the `dest` method outputs the results
)
</code></pre></figure><h4>Moving each task into small modules</h4><p>So just like <a href="https://github.com/firstandthird/load-grunt-config"><code>load-grunt-config</code></a>, it is nice to have smaller pieces of code to work with, so splitting the tasks into modules would be fairly easy. The <code>scripts.coffee</code> module would go into <code>./_src/scripts.coffee</code>, then we could just pass the gulp object to the function.</p><figure class="highlight"><pre><code class="language-coffeescript" data-lang="coffeescript"># @file _src/scripts.coffee
coffee = require(&#39;gulp-coffee&#39;)
uglify = require(&#39;gulp-uglify&#39;)
concat = require(&#39;gulp-concat&#39;)
pkg = require(&#39;../package.json&#39;)
config = require(&#39;./config.json&#39;)
isProd = ( config.env == &#39;production&#39; )

module.exports = ( gulp ) -&gt; #Pass in gulp here
  gulp.task(
    &#39;scripts&#39;, -&gt;
      gulp.src(config.paths.scripts)
        .pipe(coffee())
        .pipe(concat( pkg.name + &#39;.pkg.js&#39;))
        .pipe( if isProd then uglify() )
        .pipe(gulp.dest( config.paths.assets + &#39;/js&#39;))
  )
</code></pre></figure><p>Then it is really easy to include the individual tasks, <code>require(&#39;./scripts.coffee&#39;)(gulp)</code>, storing the config in JSON is super easy, although I guess I could use the package.json config key in the spec.</p><h4>Writing my own Jekyll plugin with a few lines</h4><p>Simple enough to get started. I think you start seeing how easy it would be to write your own plugins to use. The only jekyll plugin for gulp isn&#39;t very stable yet, so I thought I would give writting a custom task that uses the child process module to span a new process and handle the errors and stodout a bit.</p><figure class="highlight"><pre><code class="language-coffeescript" data-lang="coffeescript"># @file _gulp/jekyll.coffee
cp = require(&#39;child_process&#39;)
gutil = require(&#39;gulp-util&#39;)

module.exports = (gulp) -&gt;
  gulp.task( &#39;jekyll&#39;, -&gt;
    jekyll = cp.spawn(&#39;jekyll&#39;, [&#39;build&#39;])
    jekyll.stdout.on(&#39;data&#39;, (data)-&gt;
      console.log( &#39;jekyll: &#39; + data )
    )
    jekyll.stderr.on(&#39;data&#39;, (data)-&gt;
      error = new gutil.PluginError(&#39;jekyll&#39;, &#39;Jekyll errored with : &#39; + data )
    )
    jekyll.on(&#39;close&#39;, (code) -&gt;
      if ( code isnt 0  )
        error = new gutil.PluginError(&#39;jekyll&#39;
        , &#39;exited with code &#39; + code
        )
    )
  )
</code></pre></figure><h4>Watch is built in!</h4><p>Nifty, the watch task is just built into gulp in a nice way. It is just a method you use. Then it becomes really easy to write watch tasks here.</p><figure class="highlight"><pre><code class="language-coffeescript" data-lang="coffeescript">gulp.task(&#39;watchStyles&#39;, -&gt;
  gulp.watch(config.paths.scss, [&#39;styles&#39;])
)
</code></pre></figure><h3>So what to do now?</h3><p>I would like to get more projects using Gulp to try it out a bit more. It is hard though since I don&#39;t want to redo them just for the sake of prefering the tool. I will have to wait and see.</p></div><footer><div><ul class="pagination"><li class="prev"><a href="/2014/06/03/drupalcon-austin/" title="DrupalCon Austin">&larr;</a></li><li><a href="/archive/">Archive</a></li><li class="next"><a href="/conferences/js/2014/07/25/forward-js/" title="Forward JS">&rarr;</a></li></ul></div><div id="disqus_thread"></div><script async defeer>var disqus_developer = 1;
    var disqus_shortname = 'aboutsjbassett'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a></footer><aside><h4>Published</h4><div class="date"><span>05 June 2014</span></div><h4>Tags</h4><ul class="tag-box"><li><a href="/search/#js-ref">js <span class="label">4</span></a></li><li><a href="/search/#gulp-ref">gulp <span class="label">1</span></a></li><li><a href="/search/#front-end-ops-ref">front-end-ops <span class="label">1</span></a></li><li><a href="/search/#how-to-ref">how-to <span class="label">1</span></a></li></ul></aside></article></main></div><footer class="site-footer container" role="content-info"><div class="container clear-fix"><a href="#top" class="pull-right">Back to Top</a></div><p>&copy; Steven Bassett 2018</p><p>I &hearts; the open web.</p><ul class="social nav"><li><a href="http://www.twitter.com/bassettsj" title="Steven Bassett on Twitter">Twitter</a></li><li><a href="http://www.github.com/bassettsj" tittle="Steven Bassett on Github">Github</a></li><li><a href="http://www.linkedin.com/pub/steven-bassett/27/829/468" title="Steven Bassett on LinkedIn">LinkedIn</a></li></ul></footer><script async defer="defer" src="https://unpkg.com/st-img@0.1.1/dist/stimg.js"></script><script async defer="defer" src="/assets/js/main.pkg.js"></script><script async defer="defer">(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='https://www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create', 'UA-29704023-1', 'auto');ga('send', 'pageview');</script></body></html>